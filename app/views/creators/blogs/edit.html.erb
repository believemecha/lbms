<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

<!-- Create the editor container -->
<h3>Create a Blog</h3>
<br>
    <input type="text" placeholder="Blog Title.." class="w-100" id="title" value="<%=@blog.title%>">
<br>
<br>

<div id="editor">
  <p>Hello World!</p>
  <p>Some initial <strong>bold</strong> text</p>
  <p><br></p>
</div>

<br>

<button class="btn btn-primary btn-sm" id="create_blog" onclick="saveBlog()"> Create Blog</button>

<div id="data-cc" data-cc="<%= @blog.content_json.to_json%>"></div>


<!-- Include the Quill library -->
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<!-- Initialize Quill editor -->
<script>
const contentJson = JSON.parse(document.getElementById("data-cc").getAttribute("data-cc"));
var quill = new Quill('#editor', {
    theme: 'snow', // or 'bubble' for a different theme
    placeholder: "Start Writing..‚úçüèª",
    modules: {
      toolbar: [
        ['bold', 'italic', 'underline', 'strike'],        // toggled buttons
        ['blockquote', 'code-block'],

        [{ 'header': 1 }, { 'header': 2 }],               // custom button values
        [{ 'list': 'ordered' }, { 'list': 'bullet' }],
        [{ 'script': 'sub' }, { 'script': 'super' }],      // superscript/subscript
        [{ 'indent': '-1' }, { 'indent': '+1' }],          // outdent/indent
        [{ 'direction': 'rtl' }],                         // text direction

        [{ 'size': ['small', false, 'large', 'huge'] }],  // custom dropdown
        [{ 'header': [1, 2, 3, 4, 5, 6, false] }],

        [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme
        [{ 'font': [] }],
        [{ 'align': [] }],

        ['clean'],                                         // remove formatting button
        ['link', 'image', 'video']                         // link and image, video
      ]
    },
  });

  quill.setContents(contentJson);

  function saveBlog() {
        var title = document.getElementById("title").value;
        const btngene = document.getElementById("create_blog");
        btngene.innerHTML = "Saving..";
        btngene.disabled = true;
        $.ajax({
        type: 'POST',
        url: '/creators/blogs/make_creation',
        data: JSON.stringify({title: title, content: quill.root.innerHTML,content_json: quill.getContents(), id: "<%=@blog.id%>"}),
        headers:{
            "X-CSRF-Token": document.querySelector('meta[name="csrf-token"]').content,
            "Content-Type": "application/json"
            },
        success: function (data) {
            if(data.status == "success"){
                window.location.href = data.redirect_path
            }
            else{
                alert(data?.message);
            }
        }
        });
        btngene.innerHTML = "Create Blog";
        btngene.disabled = false;
    }


</script>